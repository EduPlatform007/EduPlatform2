/**
 * Файл переводов для страницы courses.html
 * Использует существующий механизм переводов, но с отдельным словарем
 */

// Создаем объект переводов для страницы курсов
window.coursesTranslations = {
    // Казахский язык
    kk: {
        // Заголовки и общие элементы
        courses_title: "EduPlatform - Курстар",
        courses: "Біздің курстар",
        courses_intro: "Біздің платформада әртүрлі бағыттағы курстар бар. Өзіңізге қажетті курсты таңдап, оқуды бастаңыз.",
        all_courses: "Барлық курстар",
        popular_courses: "Танымал курстар",
        
        // Фильтры
        filter_all: "Барлығы",
        filter_programming: "Бағдарламалау",
        filter_design: "Дизайн",
        filter_data: "Деректер базасы",
        filter_beginner: "Бастаушыларға",
        filter_intermediate: "Орташа деңгей",
        filter_advanced: "Жоғары деңгей",
        filter_experts: "Мамандар",
        filter_expert: "Мамандар",
        
        // Курсы
        html_course_title: "HTML/CSS негіздері",
        database_course_title: "Деректер қоры және SQL",
        python_course_title: "Python негіздері",
        html_course_title_kk: "HTML/CSS негіздері (Қазақша)",
        sql_course_title_kk: "SQL негіздері (Қазақша)",
        python_course_title_kk: "Python негіздері (Қазақша)",
        html_course_title_ru: "HTML/CSS негіздері (Русский)",
        sql_course_title_ru: "SQL негіздері (Русский)",
        python_course_title_ru: "Python негіздері (Русский)",
        
        // Заголовки курсов и описания
        html_title: "HTML/CSS",
        db_title: "Деректер қоры және SQL",
        python_title: "Python",
        html_desc_full: "Веб-әзірлеудің негіздері, сайттарды нөлден бастап құру",
        db_desc_full: "Деректерді сақтау және өңдеу негіздері, SQL сұраныс тілі",
        python_desc_full: "Python бағдарламалау негіздері, алгоритмдер және деректер құрылымы",
        
        // Кнопки и действия
        more_info: "Көбірек ақпарат",
        start_course: "Курсты бастау",
        continue: "Жалғастыру",
        lessons: "Сабақтар",
        lessons_count: "Сабақтар: ",
        auth_required: "Курстарға қол жеткізу үшін жүйеге кіру қажет",
        auth_login: "Кіру немесе тіркелу",
        
        // Преимущества
        benefits_title: "Біздің курстардың артықшылықтары",
        benefit_1_title: "Тәжірибелі оқытушылар",
        benefit_1_desc: "Біздің оқытушылар - өз саласының мамандары",
        benefit_2_title: "Интерактивті тапсырмалар",
        benefit_2_desc: "Әр сабақта тәжірибелік тапсырмалар бар",
        benefit_3_title: "Сертификаттар",
        benefit_3_desc: "Курсты аяқтағаннан кейін сертификат аласыз",
        benefit_4_title: "Қолдау көрсету",
        benefit_4_desc: "Оқу барысында тұрақты қолдау көрсетіледі",
        
        // Дополнительные переводы для страницы курсов
        benefit1_title: "Жаңартылып отыратын контент",
        benefit1_text: "Біздің курстар үнемі жаңартылып, соңғы технологиялармен толықтырылады",
        benefit2_title: "Тәжірибелік тапсырмалар",
        benefit2_text: "Әр сабақ бойынша алған білімді бекітуге арналған тәжірибелік жұмыстар",
        benefit3_title: "Кәсіби деңгейге жылдам өсу",
        benefit3_text: "Жылдам нәтижеге қол жеткізуге арналған құрылымдалған бағдарлама",
        benefit4_title: "Жеке қолдау",
        benefit4_text: "Үй тапсырмалары бойынша жеке кері байланыс және көмек"
    },
    
    // Русский язык
    ru: {
        // Заголовки и общие элементы
        courses_title: "EduPlatform - Курсы",
        courses: "Наши курсы",
        courses_intro: "На нашей платформе есть курсы по разным направлениям. Выберите нужный курс и начните обучение.",
        all_courses: "Все курсы",
        popular_courses: "Популярные курсы",
        
        // Фильтры
        filter_all: "Все",
        filter_programming: "Программирование",
        filter_design: "Дизайн",
        filter_data: "Базы данных",
        filter_beginner: "Для начинающих",
        filter_intermediate: "Средний уровень",
        filter_advanced: "Продвинутый уровень",
        filter_experts: "Эксперты",
        filter_expert: "Эксперты",
        
        // Курсы
        html_course_title: "Основы HTML/CSS",
        database_course_title: "Базы данных и SQL",
        python_course_title: "Основы Python",
        html_course_title_kk: "Основы HTML/CSS (Казахский)",
        sql_course_title_kk: "Основы SQL (Казахский)",
        python_course_title_kk: "Основы Python (Казахский)",
        html_course_title_ru: "Основы HTML/CSS (Русский)",
        sql_course_title_ru: "Основы SQL (Русский)",
        python_course_title_ru: "Основы Python (Русский)",
        
        // Заголовки курсов и описания
        html_title: "HTML/CSS",
        db_title: "Базы данных и SQL",
        python_title: "Python",
        html_desc_full: "Основы веб-разработки, создание сайтов с нуля",
        db_desc_full: "Основы хранения и обработки данных, язык запросов SQL",
        python_desc_full: "Основы программирования на Python, алгоритмы и структуры данных",
        
        // Кнопки и действия
        more_info: "Подробнее",
        start_course: "Начать курс",
        continue: "Продолжить",
        lessons: "Уроки",
        lessons_count: "Уроков: ",
        auth_required: "Для доступа к курсам необходимо войти в систему",
        auth_login: "Войти или зарегистрироваться",
        
        // Преимущества
        benefits_title: "Преимущества наших курсов",
        benefit_1_title: "Опытные преподаватели",
        benefit_1_desc: "Наши преподаватели - эксперты в своей области",
        benefit_2_title: "Интерактивные задания",
        benefit_2_desc: "Каждый урок содержит практические задания",
        benefit_3_title: "Сертификаты",
        benefit_3_desc: "После окончания курса вы получите сертификат",
        benefit_4_title: "Поддержка",
        benefit_4_desc: "Постоянная поддержка в процессе обучения",
        
        // Дополнительные переводы для страницы курсов
        benefit1_title: "Регулярно обновляемый контент",
        benefit1_text: "Наши курсы постоянно обновляются и дополняются новейшими технологиями",
        benefit2_title: "Практические задания",
        benefit2_text: "Практические задания для закрепления полученных знаний по каждому уроку",
        benefit3_title: "Быстрый рост до профессионального уровня",
        benefit3_text: "Структурированная программа для быстрого достижения результата",
        benefit4_title: "Персональная поддержка",
        benefit4_text: "Персональная обратная связь и помощь по домашним заданиям"
    }
};

// Функция для применения переводов на странице курсов
function applyCoursesTranslations() {
    // Получаем текущий язык из localStorage или используем казахский по умолчанию
    const userData = JSON.parse(localStorage.getItem('currentUser') || '{}');
    const currentLang = userData.language || 'kk';
    
    console.log('Применение переводов для страницы курсов, язык:', currentLang);
    
    // Обновляем атрибут lang для HTML
    document.documentElement.setAttribute('lang', currentLang);
    
    // Применяем переводы ко всем элементам с атрибутом data-lang-key
    document.querySelectorAll('[data-lang-key]').forEach(element => {
        const key = element.getAttribute('data-lang-key');
        
        // Сначала проверяем в coursesTranslations
        if (coursesTranslations[currentLang] && coursesTranslations[currentLang][key]) {
            if (element.tagName === 'INPUT' && element.type !== 'button' && element.type !== 'submit') {
                if (element.hasAttribute('placeholder')) {
                    element.placeholder = coursesTranslations[currentLang][key];
                } else {
                    element.value = coursesTranslations[currentLang][key];
                }
            } else {
                element.innerHTML = coursesTranslations[currentLang][key];
            }
        }
        // Если не найдено в coursesTranslations, ищем в общих переводах
        else if (window.translations && translations[currentLang] && translations[currentLang][key]) {
            if (element.tagName === 'INPUT' && element.type !== 'button' && element.type !== 'submit') {
                if (element.hasAttribute('placeholder')) {
                    element.placeholder = translations[currentLang][key];
                } else {
                    element.value = translations[currentLang][key];
                }
            } else {
                element.innerHTML = translations[currentLang][key];
            }
        }
    });

    // Обновляем заголовок страницы
    if (coursesTranslations[currentLang] && coursesTranslations[currentLang]['courses_title']) {
        document.title = coursesTranslations[currentLang]['courses_title'];
    }
    
    // Обновляем специфические элементы для страницы курсов
    if (currentLang === 'ru') {
        // Обновляем кнопки языков курсов
        document.querySelectorAll('.course-btn1').forEach(btn => {
            if (btn.textContent === 'Қазақша') {
                btn.textContent = 'Казахский';
            } else if (btn.textContent === 'Русский') {
                btn.textContent = 'Русский';
            }
        });
        
        // Обновляем теги курсов
        document.querySelectorAll('.course-tag').forEach(tag => {
            if (tag.textContent === 'Responsive') {
                tag.textContent = 'Адаптивный';
            }
            if (tag.textContent === 'Database') {
                tag.textContent = 'База данных';
            }
            if (tag.textContent === 'OOP') {
                tag.textContent = 'ООП';
            }
        });
    } else {
        // Обновляем кнопки языков курсов
        document.querySelectorAll('.course-btn1').forEach(btn => {
            if (btn.textContent === 'Казахский') {
                btn.textContent = 'Қазақша';
            } else if (btn.textContent === 'Русский') {
                btn.textContent = 'Русский';
            }
        });
        
        // Обновляем теги курсов
        document.querySelectorAll('.course-tag').forEach(tag => {
            if (tag.textContent === 'Адаптивный') {
                tag.textContent = 'Responsive';
            }
            if (tag.textContent === 'База данных') {
                tag.textContent = 'Database';
            }
            if (tag.textContent === 'ООП') {
                tag.textContent = 'OOP';
            }
        });
    }
}

// Функция для изменения языка
function changeCoursesLanguage(newLang) {
    console.log('Переключение языка на странице курсов:', newLang);
    
    // Сохраняем новый язык в localStorage
    const userData = JSON.parse(localStorage.getItem('currentUser') || '{}');
    userData.language = newLang;
    localStorage.setItem('currentUser', JSON.stringify(userData));
    
    // Обновляем атрибут lang для HTML
    document.documentElement.setAttribute('lang', newLang);
    
    // Применяем переводы
    applyCoursesTranslations();
    
    // Показываем уведомление о смене языка
    const message = newLang === 'kk' ? 'Тіл қазақшаға ауыстырылды' : 'Язык изменен на русский';
    
    // Удаляем предыдущее уведомление, если оно есть
    const existingNotification = document.querySelector('.language-notification');
    if (existingNotification) {
        document.body.removeChild(existingNotification);
    }
    
    const notificationDiv = document.createElement('div');
    notificationDiv.className = 'language-notification';
    notificationDiv.textContent = message;
    notificationDiv.style.position = 'fixed';
    notificationDiv.style.top = '10px';
    notificationDiv.style.right = '10px';
    notificationDiv.style.backgroundColor = 'rgba(0,0,0,0.7)';
    notificationDiv.style.color = 'white';
    notificationDiv.style.padding = '10px 15px';
    notificationDiv.style.borderRadius = '4px';
    notificationDiv.style.zIndex = '9999';
    document.body.appendChild(notificationDiv);
    
    setTimeout(() => {
        notificationDiv.style.opacity = '0';
        notificationDiv.style.transition = 'opacity 0.5s ease';
        setTimeout(() => {
            if (document.body.contains(notificationDiv)) {
                document.body.removeChild(notificationDiv);
            }
        }, 500);
    }, 2000);
}

// Инициализация при загрузке страницы
document.addEventListener('DOMContentLoaded', function() {
    // Настраиваем обработчики событий для селекторов языка
    document.querySelectorAll('#select, .language-selector, .switch-lang').forEach(selector => {
        if (selector.tagName === 'SELECT') {
            // Удаляем существующие обработчики и устанавливаем новый
            const newSelector = selector.cloneNode(true);
            selector.parentNode.replaceChild(newSelector, selector);
            
            // Устанавливаем обработчик события изменения
            newSelector.addEventListener('change', function() {
                const newLang = this.value === 'Қазақша' ? 'kk' : 'ru';
                changeCoursesLanguage(newLang);
            });
        } else if (selector.classList.contains('switch-lang')) {
            // Для кнопки переключения языка
            selector.addEventListener('click', function() {
                const userData = JSON.parse(localStorage.getItem('currentUser') || '{}');
                const currentLang = userData.language || 'kk';
                const newLang = currentLang === 'kk' ? 'ru' : 'kk';
                changeCoursesLanguage(newLang);
                
                // Обновляем текст кнопки
                this.textContent = newLang === 'kk' ? 'Русский' : 'Қазақша';
            });
        }
    });
    
    // Применяем переводы при загрузке страницы
    applyCoursesTranslations();
});

// Экспортируем функции в глобальную область видимости
window.applyCoursesTranslations = applyCoursesTranslations;
window.changeCoursesLanguage = changeCoursesLanguage;
